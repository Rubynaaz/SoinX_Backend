generator client_db2 {
  provider = "prisma-client-js"
  output   = "./lib/generated/prisma/db2"
}

datasource db2 {
  provider = "mongodb"
  url      = env("DATABASE_URL_2")
}

model UserProfile {
  id                        String           @id @default(auto()) @map("_id") @db2.ObjectId
  default_profile           Boolean
  default_profile_image     Boolean
  description               String?
  entities                  EntitiesProfile?
  fast_followers_count      Int?
  favourites_count          Int?
  followers_count           Int?
  friends_count             Int?
  has_custom_timelines      Boolean?
  is_translator             Boolean?
  listed_count              Int?
  media_count               Int?
  normal_followers_count    Int?
  pinned_tweet_ids_str      String[]
  possibly_sensitive        Boolean?
  profile_banner_url        String?
  profile_interstitial_type String?
  statuses_count            Int?
  translator_type           String?
  withheld_in_countries     String[]
  id_str                    String
  profile_url               String
  updated_time              DateTime

  @@map("user_profiles")
}

/// Duplicate of UserProfile mapped to user_profiles_test collection
model UserProfileTest {
  id                        String           @id @default(auto()) @map("_id") @db2.ObjectId
  default_profile           Boolean
  default_profile_image     Boolean
  description               String?
  entities                  EntitiesProfile?
  fast_followers_count      Int?
  favourites_count          Int?
  followers_count           Int?
  friends_count             Int?
  has_custom_timelines      Boolean?
  is_translator             Boolean?
  listed_count              Int?
  media_count               Int?
  normal_followers_count    Int?
  pinned_tweet_ids_str      String[]
  possibly_sensitive        Boolean?
  profile_banner_url        String?
  location                  String?
  profile_interstitial_type String?
  statuses_count            Int?
  translator_type           String?
  name                      String?
  screen_name               String?
  created_at                String?
  url                       String?
  withheld_in_countries     String[]
  user_id_str               String?
  profile_url               String?
  profile_image_url_https   String?
  verified                  Boolean?
  updated_time              DateTime?

  @@map("user_profiles_test")
}

type EntitiesProfile {
  description DescriptionProfile?
  url         UrlEntity?
}

type DescriptionProfile {
  urls UrlEntity[]
}

type UrlEntity {
  display_url  String?
  expanded_url String?
  url          String?
  indices      Int[]
}

/// Tweets data collection mapped from Twitter JSON
model TweetsData {
  id                  String     @id @default(auto()) @map("_id") @db2.ObjectId
  id_str              String
  bookmark_count      Int?
  bookmarked          Boolean?
  conversation_id_str String?
  created_at          String?
  display_text_range  Int[]
  entities            Json?
  favorite_count      Int?
  favorited           Boolean?
  full_text           String?
  is_quote_status     Boolean?
  lang                String?
  quote_count         Int?
  reply_count         Int?
  retweet_count       Int?
  retweeted           Boolean?
  user                TweetUser?
  user_id_str         String?
  views_count         String?
  updated_time        DateTime

  @@map("tweets_data")
}

/// Duplicate of TweetsData mapped to tweets_data_test collection
model TweetsDataTest {
  id                  String            @id @default(auto()) @map("_id") @db2.ObjectId
  id_str              String
  bookmark_count      Int?
  bookmarked          Boolean?
  conversation_id_str String?
  created_at          String?
  display_text_range  Int[]
  extended_entities   ExtendedEntities?
  entities            Json?
  favorite_count      Int?
  favorited           Boolean?
  full_text           String?
  is_quote_status     Boolean?
  lang                String?
  quote_count         Int?
  reply_count         Int?
  retweet_count       Int?
  retweeted           Boolean?
  twitterUrl          String?
  user                TweetUser?
  url                 String?
  user_id_str         String?
  views_count         String?
  updated_time        DateTime?

  @@map("tweets_data_test")
}

type ExtendedEntities {
  media MediaEntity[]
}

type MediaEntity {
  display_url     String?
  expanded_url    String?
  url             String?
  indices         Int[]
  media_url_https String?
  type            String?
}

/// Minimal user shape embedded in a tweet
type TweetUser {
  default_profile           Boolean
  default_profile_image     Boolean
  description               String?
  entities                  EntitiesProfile?
  fast_followers_count      Int?
  favourites_count          Int?
  followers_count           Int?
  friends_count             Int?
  has_custom_timelines      Boolean?
  is_translator             Boolean?
  listed_count              Int?
  media_count               Int?
  normal_followers_count    Int?
  pinned_tweet_ids_str      String[]
  possibly_sensitive        Boolean?
  profile_banner_url        String?
  profile_interstitial_type String?
  statuses_count            Int?
  translator_type           String?
  withheld_in_countries     String[]
}

/// Follower/Following data collection
model FollowerFollowingData {
  id                                 String       @id @default(auto()) @map("_id") @db2.ObjectId
  id_str                             String
  name                               String?
  screen_name                        String?
  location                           String?
  description                        String?
  url                                String?
  entities                           Json?
  protected                          Boolean?
  followers_count                    Int?
  fast_followers_count               Int?
  normal_followers_count             Int?
  friends_count                      Int?
  listed_count                       Int?
  created_at                         String?
  favourites_count                   Int?
  utc_offset                         String?
  time_zone                          String?
  geo_enabled                        Boolean?
  verified                           Boolean?
  statuses_count                     Int?
  media_count                        Int?
  lang                               String?
  status                             TweetStatus?
  contributors_enabled               Boolean?
  is_translator                      Boolean?
  is_translation_enabled             Boolean?
  profile_background_color           String?
  profile_background_image_url       String?
  profile_background_image_url_https String?
  profile_background_tile            Boolean?
  profile_image_url                  String?
  profile_image_url_https            String?
  profile_banner_url                 String?
  profile_link_color                 String?
  profile_sidebar_border_color       String?
  profile_sidebar_fill_color         String?
  profile_text_color                 String?
  profile_use_background_image       Boolean?
  has_extended_profile               Boolean?
  default_profile                    Boolean?
  default_profile_image              Boolean?
  pinned_tweet_ids                   Json?
  pinned_tweet_ids_str               String[]
  has_custom_timelines               Boolean?
  can_media_tag                      Boolean?
  followed_by                        Boolean?
  following                          Boolean?
  live_following                     Boolean?
  follow_request_sent                Boolean?
  notifications                      Boolean?
  muting                             Boolean?
  blocking                           Boolean?
  blocked_by                         Boolean?
  advertiser_account_type            String?
  advertiser_account_service_levels  String[]
  analytics_type                     String?
  business_profile_state             String?
  translator_type                    String?
  withheld_in_countries              String[]
  require_some_consent               Boolean?
  type                               String?
  target_username                    String?
  email                              String?

  @@map("follower_following_data")
}

/// Duplicate of FollowerFollowingData mapped to followers_data_test collection
model FollowersDataTest {
  id                                 String       @id @default(auto()) @map("_id") @db2.ObjectId
  id_str                             String
  name                               String?
  screen_name                        String?
  location                           String?
  description                        String?
  url                                String?
  entities                           Json?
  protected                          Boolean?
  followers_count                    Int?
  fast_followers_count               Int?
  normal_followers_count             Int?
  friends_count                      Int?
  listed_count                       Int?
  created_at                         String?
  favourites_count                   Int?
  utc_offset                         String?
  time_zone                          String?
  geo_enabled                        Boolean?
  verified                           Boolean?
  statuses_count                     Int?
  media_count                        Int?
  lang                               String?
  status                             TweetStatus?
  contributors_enabled               Boolean?
  is_translator                      Boolean?
  is_translation_enabled             Boolean?
  profile_background_color           String?
  profile_background_image_url       String?
  profile_background_image_url_https String?
  profile_background_tile            Boolean?
  profile_image_url                  String?
  profile_image_url_https            String?
  profile_banner_url                 String?
  profile_link_color                 String?
  profile_sidebar_border_color       String?
  profile_sidebar_fill_color         String?
  profile_text_color                 String?
  profile_use_background_image       Boolean?
  has_extended_profile               Boolean?
  default_profile                    Boolean?
  default_profile_image              Boolean?
  pinned_tweet_ids                   Json?
  pinned_tweet_ids_str               String[]
  has_custom_timelines               Boolean?
  can_media_tag                      Boolean?
  followed_by                        Boolean?
  following                          Boolean?
  live_following                     Boolean?
  follow_request_sent                Boolean?
  notifications                      Boolean?
  muting                             Boolean?
  blocking                           Boolean?
  blocked_by                         Boolean?
  advertiser_account_type            String?
  advertiser_account_service_levels  String[]
  analytics_type                     String?
  business_profile_state             String?
  translator_type                    String?
  withheld_in_countries              String[]
  require_some_consent               Boolean?
  type                               String?
  target_username                    String?
  email                              String?

  @@map("followers_data_test")
}

/// Tweet status embedded in follower data
type TweetStatus {
  created_at                String?
  id_str                    String?
  text                      String?
  truncated                 Boolean?
  entities                  Json?
  source                    String?
  in_reply_to_status_id_str String?
  in_reply_to_user_id_str   String?
  in_reply_to_screen_name   String?
  geo                       Json?
  coordinates               Json?
  place                     Json?
  contributors              Json?
  is_quote_status           Boolean?
  retweet_count             Int?
  favorite_count            Int?
  favorited                 Boolean?
  retweeted                 Boolean?
  lang                      String?
  supplemental_language     String?
  self_thread               Json?
}

/// User Analytics - Aggregated analytics data for each user
model UserAnalytics {
  id                        String   @id @default(auto()) @map("_id") @db2.ObjectId
  user_id_str               String   @unique
  name                      String?
  screen_name               String?
  description               String?
  profile_image_url_https   String?
  profile_banner_url        String?
  profile_url               String?
  verified                  Boolean?
  followers_count           Int?
  friends_count             Int?
  statuses_count            Int?
  location                  String?
  created_at                String?
  favourites_count          Int?
  listed_count              Int?
  media_count               Int?
  normal_followers_count    Int?
  pinned_tweet_ids_str      String[]
  possibly_sensitive        Boolean?
  profile_interstitial_type String?
  translator_type           String?
  withheld_in_countries     String[]

  // Aggregated tweet analytics
  total_tweets           Int    @default(0)
  total_likes            Int    @default(0)
  total_replies          Int    @default(0)
  total_retweets         Int    @default(0)
  total_views            Int    @default(0)
  total_quotes           Int    @default(0)
  avg_likes_per_tweet    Float?
  avg_replies_per_tweet  Float?
  avg_retweets_per_tweet Float?
  avg_views_per_tweet    Float?

  // Engagement Metrics
  total_engagement             Int    @default(0) // likes + replies + retweets + quotes
  avg_engagement_per_tweet     Float?
  engagement_rate              Float? // (total_engagement / total_views) * 100
  engagement_rate_by_followers Float? // (total_engagement / followers_count) * 100

  // Mindshare Metrics
  mindshare_score    Float? // Composite score based on reach, engagement, and influence
  reach_score        Float? // Based on total views
  influence_score    Float? // Based on retweets and quotes (content sharing)
  conversation_score Float? // Based on replies (conversations started)
  virality_score     Float? // Based on retweets/quotes ratio

  // Tweet details (only essential data)
  tweets TweetAnalytics[]

  // Timestamps
  first_tweet_date DateTime?
  last_tweet_date  DateTime?
  updated_at       DateTime  @default(now())

  @@map("user_analytics")
}

/// Essential tweet analytics data
type TweetAnalytics {
  tweet_id_str String
  text         String?
  created_at   String?
  tweet_date   DateTime?
  likes        Int?
  replies      Int?
  retweets     Int?
  views        String?
  quotes       Int?
  url          String?
}
