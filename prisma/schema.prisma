// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model GroupUserCountsWebhookTest {
  id              String    @id @map("_id") @db.ObjectId
  Chain           String?
  GroupName       String    @map("Group Name")
  ContractAddress String?   @map("Contract Address")
  Username        String?
  GroupUserCount  Int?      @map("Group User Count")
  MessageDateTime DateTime  @map("Message DateTime")
  FullMessage     String    @map("Full Message")
  DexscreenerData DexData[] @map("Dexscreener Data")
  CallCount       Int?      @map("Call Count")
  MessageLink     String?   @map("Message Link")

  @@map("group_user_counts_webhook_test")
}

type DexData {
  chainId       String?
  dexId         String?
  url           String?
  pairAddress   String?
  labels        String[]
  baseToken     Token?
  quoteToken    Token?
  priceNative   String?
  priceUsd      String?
  txns          TxnStats?
  volume        VolumeStats?
  priceChange   PriceChangeStats?
  liquidity     Liquidity?
  fdv           Int?
  marketCap     Int?
  pairCreatedAt BigInt?           @map("pairCreatedAt")
  info          DexInfo?
}

type Token {
  address String
  name    String?
  symbol  String?
}

type TxnStats {
  m5  TxnData?
  h1  TxnData?
  h6  TxnData?
  h24 TxnData?
}

type TxnData {
  buys  Int?
  sells Int?
}

type VolumeStats {
  h24 Float?
  h6  Float?
  h1  Float?
  m5  Float?
}

type PriceChangeStats {
  m5  Float?
  h1  Float?
  h6  Float?
  h24 Float?
}

type Liquidity {
  usd   Float?
  base  Float?
  quote Float?
}

type DexInfo {
  imageUrl  String?
  header    String?
  openGraph String?
  websites  Website[]
  socials   Social[]
}

type Website {
  label String?
  url   String?
}

type Social {
  type String?
  url  String?
}

model DexscreenerCacheNew {
  id              String           @id @default(auto()) @map("_id") @db.ObjectId
  contractAddress String           @unique @map("contract_address")
  groupUser       String?
  marketCap       Float?
  priceUsd        Float?
  updatedAt       DateTime?
  baseToken       BaseToken
  info            DexInfoCash?
  dexUrl          String?          @map("dexurl")
  historicalData  historicalData[]

  @@unique([contractAddress, groupUser])
  @@map("dexscreener_cache_new")
}

type historicalData {
  timestamp DateTime
  marketCap Float?
  volume_1h Float?
  groupUser String?
  priceUsd  Float?
}

type BaseToken {
  name   String?
  symbol String?
}

type DexInfoCash {
  imageurl  String?
  header    String?
  openGraph String?
  websites  Website[]
  socials   Social[]
}

model User {
  id            String           @id @default(auto()) @map("_id") @db.ObjectId
  walletAddress String           @unique @map("wallet_address")
  youtube       YouTubeAccount[]
}

model YouTubeAccount {
  id              String   @id @default(auto()) @map("_id") @db.ObjectId
  channelId       String   @unique @map("id")
  userId          String   @db.ObjectId
  user            User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  accessToken     String   @map("access_token")
  refreshToken    String   @map("refresh_token")
  expiry          DateTime @map("expiry")
  title           String
  description     String?
  thumbnailUrl    String?  @map("thumbnail_url")
  publishedAt     DateTime
  subscriberCount Int      @map("subscriber_count")
  videoCount      Int      @map("video_count")
  viewCount       Int      @map("view_count")
  createdAt       DateTime @default(now()) @map("created_at")
  updatedAt       DateTime @updatedAt
}

model GroupAnalytics {
  id                 String   @id @map("_id") @db.ObjectId
  groupUser          String
  groupUserCount     Int
  numContracts       Int
  avgMarketCap       Float?
  avgPriceChange     Float?
  avgMarketCapChange Float?
  totalMarketCap     Float?
  top_contract       Json?
  updatedAt          DateTime @default(now())

  @@map("group_analytics")
}

type TopContract {
  contract_address          String
  priceUsd                  Float?
  marketCap                 Float?
  priceChangeSinceFirst     Float?
  marketCapChangeSinceFirst Float?
  baseToken                 BaseToken
  updatedAt                 DateTime         @default(now())
  dexurl                    String
  info                      ContractInfo
  historicalData            HistoricalData[]
}

type ContractInfo {
  websites Website[]
  socials  Social[]
  imageurl String
}

type HistoricalData {
  priceUsd  Float?
  marketCap Float?
  timestamp DateTime
}
