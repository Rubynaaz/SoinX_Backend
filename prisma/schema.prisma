// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model GroupUserCountsWebhookTest {
  id              String    @id @map("_id") @db.ObjectId
  Chain           String?
  GroupName       String    @map("Group Name")
  ContractAddress String?   @map("Contract Address")
  Username        String?
  GroupUserCount  Int?      @map("Group User Count")
  MessageDateTime DateTime  @map("Message DateTime")
  FullMessage     String    @map("Full Message")
  DexscreenerData DexData[] @map("Dexscreener Data")
  CallCount       Int?      @map("Call Count")
  MessageLink     String?   @map("Message Link")

  @@map("telegram_influencer_data")
}

type DexData {
  chainId       String?
  dexId         String?
  url           String?
  pairAddress   String?
  labels        String[]
  baseToken     Token?
  quoteToken    Token?
  priceNative   String?
  priceUsd      String?
  txns          TxnStats?
  volume        VolumeStats?
  priceChange   PriceChangeStats?
  liquidity     Liquidity?
  fdv           Int?
  marketCap     Int?
  pairCreatedAt BigInt?           @map("pairCreatedAt")
  info          DexInfo?
}

type Token {
  address String
  name    String?
  symbol  String?
}

type TxnStats {
  m5  TxnData?
  h1  TxnData?
  h6  TxnData?
  h24 TxnData?
}

type TxnData {
  buys  Int?
  sells Int?
}

type VolumeStats {
  h24 Float?
  h6  Float?
  h1  Float?
  m5  Float?
}

type PriceChangeStats {
  m5  Float?
  h1  Float?
  h6  Float?
  h24 Float?
}

type Liquidity {
  usd   Float?
  base  Float?
  quote Float?
}

type DexInfo {
  imageUrl  String?
  header    String?
  openGraph String?
  websites  Website[]
  socials   Social[]
}

type Website {
  label String?
  url   String?
}

type Social {
  type String?
  url  String?
}

model DexscreenerCacheNew {
  id              String           @id @default(auto()) @map("_id") @db.ObjectId
  contractAddress String           @map("contract_address")
  groupUser       String?
  marketCap       Float?
  priceUsd        Float?
  updatedAt       DateTime?
  baseToken       BaseToken
  info            DexInfoCash?
  dexUrl          String?          @map("dexurl")
  historicalData  historicalData[]

  @@unique([contractAddress, groupUser])
  @@map("dexscreener_cache_new")
}

type historicalData {
  timestamp DateTime
  marketCap Float?
  volume_1h Float?
  groupUser String?
  priceUsd  Float?
}

type BaseToken {
  name   String?
  symbol String?
}

type DexInfoCash {
  imageurl  String?
  header    String?
  openGraph String?
  websites  Website[]
  socials   Social[]
}

// model User {
//   id            String           @id @default(auto()) @map("_id") @db.ObjectId
//   walletAddress String           @unique @map("wallet_address")
//   // youtube       YouTubeAccount[]
// }

// model YouTubeAccount {
//   id              String   @id @default(auto()) @map("_id") @db.ObjectId
//   channelId       String   @unique @map("id")
//   userId          String   @db.ObjectId
//   user            User     @relation(fields: [userId], references: [id], onDelete: Cascade)
//   accessToken     String   @map("access_token")
//   refreshToken    String   @map("refresh_token")
//   expiry          DateTime @map("expiry")
//   title           String
//   description     String?
//   thumbnailUrl    String?  @map("thumbnail_url")
//   publishedAt     DateTime
//   subscriberCount Int      @map("subscriber_count")
//   videoCount      Int      @map("video_count")
//   viewCount       Int      @map("view_count")
//   createdAt       DateTime @default(now()) @map("created_at")
//   updatedAt       DateTime @updatedAt
// }

model GroupAnalytics {
  id                 String   @id @default(auto()) @map("_id") @db.ObjectId
  groupUser          String
  groupUserCount     Int
  numContracts       Int
  avgMarketCap       Float?
  avgPriceChange     Float?
  avgMarketCapChange Float?
  totalMarketCap     Float?
  top_contract       Json?
  updatedAt          DateTime @default(now())

  @@map("group_analytics")
}

model GroupAnalyticsDetailed {
  id                    String                    @id @default(auto()) @map("_id") @db.ObjectId
  groupName              String                    @map("group_name")
  username               String?                   @map("username")
  groupUserCount         Int                       @map("group_user_count")
  totalCalls             Int                       @map("total_calls")
  totalUniqueContracts   Int                       @map("total_unique_contracts")
  positiveCalls          Int                       @map("positive_calls")
  negativeCalls          Int                       @map("negative_calls")
  successRate            Float?                    @map("success_rate")
  avgPriceChange         Float?                    @map("avg_price_change")
  avgMarketCapChange     Float?                    @map("avg_marketcap_change")
  avgMultiplierX         Float?                    @map("avg_multiplier_x")
  bestCall               GroupBestCall?
  lastCall               GroupLastCall?
  contracts              GroupContractPerformance[]
  lastMessageDateTime    DateTime?                 @map("last_message_datetime")
  createdAt              DateTime                  @default(now()) @map("created_at")
  updatedAt              DateTime                  @updatedAt @map("updated_at")

  @@index([groupName, username])
  @@map("group_analytics_detailed")
}

type GroupBestCall {
  contractAddress String
  tokenName       String?
  tokenSymbol     String?
  tokenImage      String?
  chain           String?
  priceChange     Float?
  marketCapChange Float?
  multiplierX     Float?
  messageDateTime DateTime?
}

type GroupLastCall {
  contractAddress String
  tokenName       String?
  tokenSymbol     String?
  tokenImage      String?
  chain           String?
  priceChange     Float?
  marketCapChange Float?
  multiplierX     Float?
  messageDateTime DateTime?
}

type GroupContractPerformance {
  contractAddress    String
  tokenName          String?
  tokenSymbol        String?
  tokenImage         String?
  chain              String?
  initialPrice       Float?
  initialMarketCap   Float?
  currentPrice       Float?
  currentMarketCap   Float?
  priceChange        Float?
  marketCapChange    Float?
  multiplierX        Float?
  callCount          Int
  firstCallDateTime  DateTime?
  lastCallDateTime   DateTime?
  performance        String? // "positive", "negative", "neutral"
}

type TopContract {
  contract_address          String
  priceUsd                  Float?
  marketCap                 Float?
  priceChangeSinceFirst     Float?
  marketCapChangeSinceFirst Float?
  baseToken                 BaseToken
  updatedAt                 DateTime         @default(now())
  dexurl                    String
  info                      ContractInfo
  historicalData            HistoricalData[]
}

type ContractInfo {
  websites Website[]
  socials  Social[]
  imageurl String
}

type HistoricalData {
  priceUsd  Float?
  marketCap Float?
  timestamp DateTime
}

model TwitterData {
  id     String  @id @map("_id") @db.ObjectId
  url    String
  user   Json

  // @@map("user_profiles")
}

type User {
  id                           String
  rest_id                      String
  affiliates_highlighted_label AffiliatesHighlightedLabel?
  avatar                       Avatar?
  core                         Core
  dm_permissions               Json?
  is_blue_verified             Boolean
  legacy                       Legacy
  location                     Location?
  media_permissions            Json?
  parody_commentary_fan_label  String?
  profile_image_shape          String?
  professional                 Professional?
  privacy                      Privacy?
  relationship_perspectives    Json?
  tipjar_settings              TipjarSettings?
  verification                 Verification?
  legacy_extended_profile      Json?
  is_profile_translatable      Boolean?
  has_hidden_subscriptions_on_profile Boolean?
  verification_info            VerificationInfo?
  highlights_info              HighlightsInfo?
  user_seed_tweet_count        Int?
  business_account             Json?
  creator_subscriptions_count  Int?
}

type AffiliatesHighlightedLabel {
  label Label
}

type Label {
  url                      Url?
  badge                    Badge?
  description              String?
  userLabelType            String?
  userLabelDisplayType     String?
}

type Url {
  url      String?
  urlType  String?
}

type Badge {
  url String?
}

type Avatar {
  image_url String?
}

type Core {
  created_at  String
  name        String
  screen_name String
}

type Legacy {
  default_profile           Boolean
  default_profile_image      Boolean
  description                String?
  entities                   Entities?
  fast_followers_count       Int?
  favourites_count           Int?
  followers_count            Int?
  friends_count              Int?
  has_custom_timelines       Boolean?
  is_translator              Boolean?
  listed_count               Int?
  media_count                Int?
  normal_followers_count     Int?
  pinned_tweet_ids_str       String[]
  possibly_sensitive          Boolean?
  profile_banner_url         String?
  profile_interstitial_type  String?
  statuses_count             Int?
  translator_type            String?
  withheld_in_countries      String[]
}

type Entities {
  description Description?
}

type Description {
  urls String[]
}

type Location {
  location String?
}

type Professional {
  rest_id           String?
  professional_type String?
  category          String[]
}

type Privacy {
  protected Boolean?
}

type TipjarSettings {
  is_enabled       Boolean?
  bandcamp_handle  String?
  bitcoin_handle   String?
  cash_app_handle  String?
  ethereum_handle  String?
  gofundme_handle  String?
  patreon_handle   String?
  pay_pal_handle   String?
  venmo_handle     String?
}

type Verification {
  verified Boolean?
}

type VerificationInfo {
  is_identity_verified Boolean?
  reason               VerificationReason?
}

type VerificationReason {
  description           VerificationDescription?
  verified_since_msec   String?
  override_verified_year Int?
}

type VerificationDescription {
  text      String?
  entities  Json?
}

type HighlightsInfo {
  can_highlight_tweets Boolean?
  highlighted_tweets   String?
}

model DexLatestData {
  id              String          @id @default(auto()) @map("_id") @db.ObjectId
  contractAddress String          @unique @map("contract_address")
  historicalData  HistoricalPriceData[]
  createdAt       DateTime        @default(now()) @map("created_at")
  updatedAt       DateTime?       @updatedAt @map("updated_at")

  @@map("dex_latest_data")
}

type HistoricalPriceData {
  priceUsd  Float?
  marketCap Float?
  timestamp DateTime
}


model TelegramUserData{
  id                   String    @id @map("_id") @db.ObjectId
  contract_address     String    @unique @map("contract_address")
  group_name           String    @map("group_name")
  username             String    @map("username")
  token_name           String?    @map("token_name")
  token_symbol         String?    @map("token_symbol")
  dex_url              String?    @map("dex_url")
  full_message         String    @map("full_message")
  chain                String?    @map("chain")
  call_count           Int       @map("call_count")
  social_links         Social[]   @map("social_links")
  token_image          String?    @map("token_image")
  banner_image         String?    @map("banner_image")
  price_usd            Float?     @map("price_usd")
  market_cap           Float?     @map("market_cap")
  user_count           Int?       @map("user_count")
  message_datetime     DateTime?  @map("message_datetime")

  @@map("telegram_influencer_data_simplified")
}